ff14AuraCan0.9说明文档

结构
ff14AuraCan
|-core 	1
||-daily 	1.4
|||-rp_gazeat 	1.4.2
||||-rp_gazeat_add 	1.4.2.1
||||-rp_gazeat_iterator 	1.4.2.2
||||-rp_gazeat_remove 	1.4.2.3
|||-rp_members 	1.4.1
||||-rp_members_add 	1.4.1.1
||||-rp_members_iterator 	1.4.1.2
||||-rp_members_remove 	1.4.1.1
|||-rp_near 	1.4.3
||||-rp_near_add 	1.4.3
||||-rp_near_iterator 	1.4.3
||||-rp_near_remove 	1.4.3
|||-trigger 	1.4.4
||||-1s_trigger 	1.4.4
||-init 	1.1
|||-triggernornomety_onload 	1.1.1
|||-zone_onload 	1.1.2
||-read 	1.5
|||-sgazeat 	1.5.1
||-record 	1.6
|||-message 	1.6.1
|||-other 	1.6.2
|||-random 	1.6.3
||-set 	1.2
|||-away 	1.2.3
|||-keyword 	1.2.4
|||-staticswitch 	1.2.2
|||-switch 	1.2.1
||-show 	1.7
|||-show_members 	1.7.1
||-system 	1.3
|||-away 	1.3.1
|||-keyword 	1.3.2
|-交易相关 	2
||-收到队友交易提醒
||-收到非队友交易提醒
|-朗读发言 	3
||-朗读喊话内容
||-朗读呼喊内容
||-朗读跨服贝1发言
||-朗读跨服贝2发言
||-朗读跨服贝3发言
||-朗读跨服贝4发言
||-朗读跨服贝5发言
||-朗读跨服贝6发言
||-朗读跨服贝7发言
||-朗读跨服贝8发言
||-朗读悄悄话
||-朗读小队内队友发言
||-朗读小队内自己发言
|-情感动作提醒 	4
||-em命令互动提醒
||-原生情感动作互动提醒
|-投掷相关 	5
||-小队dice显示
|||-/e dice clear清空记录
|||-小队dice
||-他人random点数
||-自己random点数
|-组队相关 	6
||-被邀请组队
||-加入队伍后每半小时提醒(同服)

0.前言
0.1用词
这里简单介绍以下篇幅会使用的词汇
1)龙罐头(ff14AuraCan)利用ACT插件制作的RP店营业辅助用触发器,该文档所介绍的东西.有新需求/改进建议/需要帮助可以联系作者
叫龙罐头是因为我游戏角色是敖龙族,不是让你拿来抓龙的,也不是什么龙骑士辅助工具
开发与测试基于Windows10操作系统,部分功能或全部功能不适用其他系统
2)高级触发器
又名增强型触发器/Triggernometry,龙罐头完全依赖高级触发器,安装介绍及使用方法请查看
https://bbs.nga.cn/read.php?tid=20779526(nga上前辈的帖子)
https://github.com/paissaheavyindustries/Triggernometry/wiki(插件作者编写的英文介绍文档)
该插件通常用来帮助玩家攻略高难任务,用来为RP店营业提供帮助纯属歪门邪道
3)分组
可以理解为文件夹
4)触发器
匹配游戏日志文件然后执行特定动作(或动作列表),龙罐头0.9版本包含19个分组以及其下46个触发器
5)动作:
触发器具体做的事情,比如通过你的耳机吼了一嗓子:塔塔露在看你/塔塔露靠近了
0.2关于导入时的警告
导入时插件会发出警告,提示某些触发器很危险(能执行任意代码的触发器确实很危险).这些触发器均位于负责进行记录的record分组下,如你不信任这些触发器(比如该xml文件来源无法保证或担心该功能危害你的计算机),请将其删除.它们不会影响其他项目
0.3双开问题
双开无法工作是因为ACT本身对双开不是太友好.不过根据反馈来看使用触发器在后台监控你的另一个游戏客户端是可行的
0.4变量兼容性问题
龙罐头创建的所有变量均使用"rp_"开头,通常不会产生变量名冲突的问题
0.5故障排查与重启操作
不建议同时启动act与游戏,可能会初始化失败,建议其中之一完全启动后再运行另一个
如果你熟悉Triggernormetry,你完全可以自己排查问题,否则出现故障时请做如下排查:
	1.ACT打不开,运行时报错,Triggernormetry报错或不会使用:
	1)去因特网查找问题解决办法
	2)去nga查看帖子或尝试联系原作者求助
	3)向我求助,我大概率解决不了但是我可以安慰你
	2.通过远程触发器导入龙罐头失败:
	1)源代码保存在github上,网站略卡,请换一个时间段或多尝试几次
	2)如果有其他渠道获取也可以,但是请注意安全
	3)参考我下面的解析自己做一个,遇到问题可以向我求助
	3.语音播报相关功能无效:
	1)重新运行switch宏,详细请参考[1.2.1.switch].如果运行宏时连嘟的一声都没有,请检查你的声音播放设备和你的ACT是否正常工作
	2)排查是否语音合成相关模块出了问题,这一部分我没有相关经验,请联系会使用ACT的亲友或者自己随便点点
	3)如果你的客人或你的同事打字飞快以至于卡死了你的语音合成,这不是什么大问题,稍后重启电脑即可.该部分稍微做过优化,但优化后我没再遇到过打字这么快的客人了.重申:别开着入场提醒功能进海都
	4.记录相关功能不记录类型:
	1)可能是初始化失败了,请尝试手动初始化
	2)若有需要请重新运行staticswitch方法,请参考[1.2.2.staticswitch]
	5.记录相关功能不记录
	1)用电脑全局搜一下你的日志文件,可能它运行的很好但是你没有找到
	2)若使用本地触发器,请尝试重新导入
	3)若使用远程触发器,请给它相关权限
	4)联系懂C#的朋友,如有需要打开record下的相关组件,发送代码给ta帮助你排查
	5)美好的回忆十分重要,如果到了这一步你仍然不愿放弃请联系我,我会尽最大努力尝试解决
	6.记录文件部分时间错乱
	大概率是你电脑时间不准并且初始化失败,请手动初始化
	7.set功能无效/没有嘟声:
	1)查看聊天框默语频道是不是没有正常显示
	2)检查声音播放设备是否存在问题
	3)检查ACT是否正常工作
	8.show功能没有显示
	1)别全屏开游戏
	2)查看其它ACT插件悬浮窗是否正常工作(如显示队友dps的插件或网络延迟插件)
	9.手动初始化方法:
	右键core->init下的triggernomety_onload触发器,然后点击执行来手动初始化
	可能需要重新set
0.6关于龙罐头的看法
1)龙罐头创作的初衷是不冷落客人,不淡忘客人,认真陪伴每位客人.请不要开十个号收十份指名费或者开黑店让客人输个精光.树洞类指名或被要求谈话内容进行保密的活动请关闭龙罐头的记录功能
2)龙罐头的记录功能无法作为被欺凌时的决定性证据,请保护好自己.若客人骚扰你或同事请截图并前往官网进行举报
1.core
核心层,其实并不全是核心.包含负责初始化该插件的init,设置相关的set,日常维护各种变量的daily,朗读/记录/浮窗相关的read/record/show,会朝游戏发送消息的system
1.1.init
该分组用于初始化变量
1.1.1.triggernornomety_onload
在角色进入游戏时会设置变量,我选其中一部分进行说明:
rp_summoned:朝日小仙女|夕月小仙女|绿宝石兽|黄宝石兽|红宝石兽|迦楼罗之灵|泰坦之灵|伊弗利特之灵
召唤物名,用来区分客人与召唤物,如果你不想将某位玩家视作客人,请手动将该玩家角色名补充至变量末尾(不需要添加服务器名),使用|分隔
rp_switch 与 rp_static_switch
该两个变量控制某些功能是否启用,详细信息请阅读set相关章节
rp_time_difference
记录你电脑与游戏服务器时间的时差,龙罐头相关各功能使用时间均为服务器时间,若果你执意要在本触发器加载完毕后修改电脑时间,我
1.1.2.zone_onload
角色更换地图时触发,它做如下工作:
初始化当前区域玩家列表
初始化正选中你的玩家列表
初始化你附近(目标圈相距一米内)的玩家列表
初始化你当前启用功能为默认启用功能
1.2.set
使用默语频道进行一些设置的触发器所在的分组.因为是默语频道,所以你可以做一些宏来开开关关
举个例子,你可以做两个宏:一是没被指名时开启的功能-入场提醒,被注视提醒,靠近提醒,注视你时朗读白字发言.二是被指名时开启的功能-只包含注视提醒
这样你就可以不切出游戏进行操作,对全屏游戏的玩家也会相对友好一些(会有玩家使用全屏的同时使用ACT吗?)
1.2.1.switch
设置当前启用的功能,写错了不会有大问题,最多相关功能不好使,设置成功会发出0.1毫秒的鸣笛
如果你想关闭所有功能,可以将第二个参数写为empty或者其他什么非可选参数词
切换地图时会被重置为默认启用功能
宏命令格式为:
/e switch 功能1[|功能2[|功能3...]]
举例:
/e switch in|gazeat|near|sgazeat
/e switch gazeat
0.9版本功能可选参数:
in	入场提醒
out		离场提醒
near	靠近提醒
far	远离提醒
gazeat	注视提醒
turn	移开目光提醒
sgazeat	被注视时对方说话频道内容朗读
showmembers	在屏幕左侧显示当前所在区域玩家列表
1.2.2.staticswitch
设置默认启用功能,在切换地图时会将启用功能还原为默认启用功能,设置成功会发出0.1毫秒的鸣笛
默认启用功能会在重启act后恢复为empty,即默认不启用任何功能
宏命令格式为:
/e defaultswitch 功能1[|功能2[|功能3...]]
可选参数同switch可选参数,但是不包含入场提醒功能
1)请不要将入场提醒功能(in)置为默认功能或之一
2)如果你执意违反1),请不要去海都
3)如果你执意违反2),请在人少时去
4)如果你执意违反3),请立即关闭ACT
5)如果你执意违反4)或已无法关闭ACT,请尽量关闭游戏重启电脑,离开海都后再启动ACT
不建议开着入场提醒去海都的原因是海都人太多了,使用showmembers功能可以注意到海都大水晶附近时常会有近300人(观测到过286).当你传送进海都的时候游戏会瞬间打印286人入场的日志,之后触发器会瞬间触发286次
到这里都没什么问题,但如果你的语音合成器试图同时合成播放这些语音会崩掉你的ACT,连带着崩掉你的游戏和电脑
入场语音提醒加过限制,但并不能完全解决问题,在海都人最多的时段入场还是会崩掉
你可以进入到海都之后开启入场提醒,之后你的声音播放设备大概会一直在播报
1.2.3.away
设置一个按键,角色离开后会向游戏发送该按键,详细可以查看system章节下的away
宏格式:
/e away 按键
示例:
/e away n
会在角色离开后按下n
按键可选字符:
小写字母a-z
1.2.4.keyword
设置一个关键词,当聊天频道出现该关键词时声音播放设备会鸣笛,详细可以查看system章节下的keyword,多个关键词使用|分隔
宏格式:
/e keyword 关键词1[|关键词2[|关键词3...]]
示例:
/e keyword 客人
/e keyword 客人|走
希望该触发器不再工作可以使用如下宏命令
/e keyword
关键词似乎没太多限制的样子,甚至你放点游戏特殊符号大概也能正常工作(别放空格换行符)
1.3.system
我已经忘了为什么该分组名为system,可能是为了不让使用者看懂
1.3.1.away
在提示:"一段时间内没有进行任何操作，已经自动切换为离开状态"后向你的游戏窗口发送你设置好的按键
这一过程有六秒的延迟,这么做的原因是当你切换至离开状态后立即移动鼠标或敲击键盘是不会恢复为在线状态的(至少自己的视角是这样),因此加了这个延迟
不建议各位被接待时因为长时间未操作而被切换为离开状态,这样是十分失礼的
同样提醒大家切换后别忘了挂标(希望组队/魔晶石镶嵌/角色扮演)
远程触发器请在创建时勾选[更新和权限]中的[允许触发器发送窗口消息]
1.3.2.keyword
当跨服通讯贝,小队频道,呼喊频道,喊话频道,悄悄话频道,情感动作频道出现该关键词时声音播放设备会鸣笛,该鸣笛声为0.3秒,略长于其他多数功能
该触发器虽然理论上会拖慢龙罐头的效率,但据观察它工作的还不错
1.4.daily
出入场提醒,注视提醒,靠近远离提醒的核心;其他一些功能的前置,并负责维护几个常用列表
1.4.1.rp_members
维护当前区域角色列表,被注视提醒功能/靠近提醒功能/当前区域玩家显示功能依赖
1.4.1.1.rp_members_add 与 rp_members_remove
角色入场与角色离场ACT会打印日志信息,该触发器根据日志信息进行播报并维护一个当前区域角色列表.
该触发器无法在海都很好的工作,你会注意到列表中人物越来越多
这个问题不是很好排查/修复/优化.海都人物显示不全,我都不知道我身边有谁
尽管人物变多了,但通常不会影响靠近远离提醒和注视提醒等功能,愿意的话可以帮我做个测试:
开着龙罐头的showmembers功能在海都大水晶旁挂机一星期,看看崩掉的时候显示的玩家数量(在玩家列表左上角)
1.4.1.2.rp_members_iterator
遍历当前区域角色列表,满足条件就调用 rp_gazeat_add/rp_near_add
1.4.2.rp_gazeat
注视提醒与记录功能,依赖rp_members列表与记录功能
这个功能有约一秒的延迟,可以缩短到0.5秒但没有意义,因为游戏相关部分延迟都有约0.5秒喵
请不要一有好看的角色在看你就克制不住自己人设崩塌,请保持理智
请不要认为有人在看你就认为ta对你有想法,可能是鼠标坏了,请保持理智
请不要因为有人看了你一眼然后飞速转移视线就认为ta在害羞,也许只是点错了,请保持理智
这个功能做出来后才意识到每天有多少人会有意无意的点到我的角色
1.4.2.1.rp_gazeat_add
1)维护 rp_gazeat 列表
2)调用 record 下的 other 进行记录
3)如开关开启播读xxx在看你
1.4.2.2.rp_gazeat_iterator
遍历注视列表,不再注视则调用 rp_gazeat_remove
1.4.2.3.rp_gazeat_remove
1)维护 rp_gazeat 列表
2)调用 record 下的 other 进行记录
3)若开关开启播读xxx移开了目光
1.4.3.rp_near
没什么额外要补充的,该分组下触发器本身就是用 rp_gazeat 修改了触发条件制成的
它会记录双方角色目标圈相距一米以内的角色id,并维护一个名为rp_near的列表,目前来看作用十分鸡肋,也许未来能设计出实用的功能来
1.4.4.trigger
该分组下存放的是不同频率的定时任务,1s_trigger的意思是一秒执行一次
如果想使调用频率不这么高,请修改动作列表最底端调用自身的触发器和计划任务页签的触发器再次调用周期
1.5.read
存放朗读相关触发器的分组,由于0.9版本龙罐头其他朗读触发器无依赖,所以该分组下只存放了 sgazeat
1.5.1.sgazeat
被其他角色注视(严格来说是硬选中,游戏人物面向该角色/玩家的碳基生物体用眼睛集中注意力注视/软选中不在该范围内)时朗读该角色说话频道的内容,依赖 rp_gazeat 列表
1.6.record
该分组负责的功能为记录,严格来说是将一些信息写入txt文件
该txt文件的路径为act根目录,和act.exe(其他版本ACT请自行摸索)放在一起,日志文件名为yyyy-MM-dd.txt(记录日期.txt)
如果你找到了该文件,基本能说明记录相关功能是正常工作的(至少正常工作过)
在0.9版本,该分组下各触发器均记录在同一文件内.该记录文件内时间以游戏为准,龙罐头不会整理日志文件,请定期手动整理
关于触发器载入时报警请查看[0.2关于导入时的警告],远程触发器若想使用请在创建时勾选[更新和权限]中的[允许触发器执行代码]
记录文件可以修改,但你可能会遗失在修改时写入的记录
1.6.1.message
记录ACT日志中以00开头的内容,即ACT自己生成的日志.这部分包含了我们需要的聊天信息,格式为[时间]类型:角色名:具体内容
类型如下:
cwl1~8:跨服贝1~8
s:说话频道(所有角色)
sh:喊话频道(所有角色)
t:他人向你发送的悄悄话
p:小队频道(包含自己)
em:情感动作与em宏.关于区分情感动作与em宏,可以凭经验.也可以看第二个分号后的具体内容中有没有再写一遍角色名,有两个角色名的为用户宏
y:呼喊频道
如以上条目没有记录类型,可能是龙罐头初始化失败
其他类型也会记录,但不会记录具体类型(如自己向他人发送的悄悄话),会尽量在下一版本补上
特别地,npc剧情中的发言也属于00开头,但龙罐头不会进行记录.我们往往不希望boss的发言混入其中
1.6.2.other
记录的通用方法,如想记录信息,只需触发该触发器
该触发器会校准系统时间至游戏时间,但若系统初始化失败则不会校准
1.6.3.random
仅记录random信息,时间不会校准,若不想使用该功能只需取消勾选
1.7.show
在界面上显示信息
1.7.1.show_members
显示当前区域玩家列表,依赖 rp_members 列表,该触发器会将该列表转化为一个使用换行符分隔的变量
若使用宏命令(/e switch)取消使用该功能不会取消浮窗显示,只是停止更新.相关改动会在下一版本优化
2.交易相关
勾上就能发挥作用
语音播报收到交易提醒的功能,两个触发器的提示语音分别为"收到了队友,xxx发来的交易申请"和"收到了xxx发来的交易申请"
3.朗读发言
勾上就能发挥作用
特别地,[朗读小队内队友发言]与[朗读小队内自己发言]被拆开了.其日志为同一代码,但由于复读自己的发言有时过于羞耻所以被拆开了
该功能跨服小队或同服小队都有效
4.情感动作提醒
两种情感动作都加了对自己使用才会提醒的限制,日志根据角色名匹配而不是是否选中你来进行判断,有利有弊
5.投掷相关
投掷相关的功能,也是勾上就能用
5.1.小队dice显示
这个功能是自用的半成品,不小心一并发上去了
店里的21点游戏如果能记录队友的dice点数会很方便,该插件应运而生
会在屏幕左上角对内各个角色的dice点数(上限为10的才会记录),使用另一条宏可以清空
有需要可以自己改改或者联系我帮忙
未来会修改的更为通用或者删除该分组
5.2.他人random点数/自己random点数
个人认为比较鸡肋的功能,会播报xxx掷出了xxx点,多数时候被我关着,蛮吵的
6.组队相关
6.1.被邀请组队
会播读"收到了xxx的邀请"
6.2.加入队伍后每半小时提醒(同服)
龙罐头会在你加入队伍后开始计时,分别在30min,60min,90min,120min发出语音提醒"已入队xx分钟",若退出小队或解散小队则终止计时
1)队友退出或加入不会影响计时
2)小队变跨服队没测试过
3)一些特殊场地,如博兹雅战线,该触发器会工作的很奇怪
4)未来可.能.会优化